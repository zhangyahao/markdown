1.  写入数据
    1. 顺序写入<br>
        磁盘读写的快慢取决于你怎么使用它，也就是顺序读写或者随机读写。在顺序读写的情况下，磁盘的顺序读写速度和内存持平。
        
        因为硬盘是机械结构，每次读写都会寻址->写入，其中寻址是一个“机械动作”，它是最耗时的。所以硬盘最讨厌随机I/O，最喜欢顺序I/O。为了提高读写硬盘的速度，Kafka就是使用顺序I/O。
        
        ```aidl
            顺序IO是指读取和写入操作基于逻辑块逐个连续访问来自相邻地址的数据。在顺序IO访问中，HDD所需的磁道搜索时间显着减少，
            因为读/写磁头可以以最小的移动访问下一个块。数据备份和日志记录等业务是顺序IO业务。随机IO是指读写操作时间连续，
            但访问地址不连续，随机分布在磁盘LUN的地址空间中。产生随机IO的业务有OLTP服务，SQL，即时消息服务等。

        ```
        使用磁盘来做顺序写入的好处：<br>    
          1. 顺序写入磁盘顺序读写速度超过内存随机读写
          2. 顺序写入JVM的GC效率低，内存占用大。使用磁盘可以避免这一问题
          3. 顺序写入系统冷启动后，磁盘缓存依然可用
        
        缺点： 没有办法删除数据 ，所以Kafka是不会删除数据的，它会把所有的数据都保留下来，每个消费者（Consumer）对每个Topic都有一个offset用来表示读取到了第几条数据 。
            
    2.  Memory Mapped Files<br>
        Memory Mapped Files(后面简称mmap)也被翻译成 内存映射文件 ，在64位操作系统中一般可以表示20G的数据文件，它的工作原理是直接利用操作系统的Page来实现文件到物理内存的直接映射。
        完成映射之后你对物理内存的操作会被同步到硬盘上（操作系统在适当的时候）。
2.  读取数据        
      1.  基于sendfile实现Zero Copy
      2.  批量压缩
3.  总结
    kafka速度的秘诀在于，它把所有的消息都变成一个批量的文件，并且进行合理的批量压缩，减少网络IO损耗，通过mmap提高I/O速度，写入数据的时候由于单个Partion是末尾添加所以速度最优；读取数据的时候配合sendfile直接暴力输出。